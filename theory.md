Модели не хватит данных для предсказания, надо заполнить датасет данными, т. е. подтянуть финансовые показатели или другие метрики на основании которых модель сможет делать точные предсказания
- Можно попробовать спарсить сайт yahoo finance и получить информацию по финансовым показателям организации за последний год
- Можно попробовать в качестве дополнительных признаков подтянуть EMA за последний день/месяц/квартал

В любом случае модель сейчас будет опираться только на дату

Финансовые данные считаются за кварталы, а мне желательно предсказывать движение цены по дням, получается для некоторых групп данных будет использоваться одни и те же финансовые показатели, это послужит неким усредняющим фактором. И тогда в ситуации, когда я захочу предсказать данные на следующие 3 месяца, то я буду опираться только на уже имеющиеся финансовые показатели (т. е. финансовые показатели будут на текущий момент и они будут одни для всего датасета, а предсказывать цену я буду на будущий)

Это нормальная практика в таких ситуациях, но есть несколько нюансов:

Фундаментальные данные как медленный показатель:
Финансовые показатели, такие как выручка или прибыль, меняются не каждый день, а предоставляют общий контекст по состоянию компании за более длинные периоды. Это поможет отразить долгосрочные тенденции, но может не учесть краткосрочные колебания.

Использование усредняющих показателей:
Финансовые показатели в будущем не изменятся до публикации нового отчета, поэтому твоя модель будет использовать текущее состояние компании для прогноза будущих цен. Это типичный подход, но он может не полностью захватить динамику краткосрочных изменений рынка.

Дополнение модели макроэкономическими данными:
Для компенсации неизменности финансовых показателей можно попробовать добавить экономические данные (например, процентные ставки или индексы), которые могут меняться более часто и оказывать влияние на цены акций в краткосрочной перспективе.

Тренды и сезонность:
Так как у тебя есть временные признаки и технические индикаторы, они могут помочь уловить краткосрочные и сезонные тренды, которые финансовые данные не смогут отразить.

В итоге, финансовые показатели будут давать модель долгосрочный контекст, а технические индикаторы и временные признаки — более детализированное понимание краткосрочных изменений.

Добавление технических метрик за разные периоды, такие как день, месяц или квартал, может существенно улучшить качество предсказаний. Вот почему:

Почему это полезно:

Мультискейловый анализ:
Технические индикаторы за разные периоды помогают захватить как краткосрочные, так и долгосрочные тренды. Например, добавление EMA за последний день выявит краткосрочные колебания, в то время как EMA за месяц или квартал покажет более устойчивый тренд.

Учет рыночной инерции:
Часто бывает полезно отслеживать изменения индикаторов на разных временных масштабах. Например, если EMA за последний день резко отличается от EMA за месяц, это может указывать на начало нового тренда или коррекцию.

Сглаживание шума:
Использование индикаторов за квартал или месяц может сгладить краткосрочные аномалии или шумы, что важно для долгосрочного прогноза.

Динамика рынка:
Некоторые технические индикаторы, такие как RSI, MACD или Bollinger Bands, за разные периоды могут указывать на изменяющуюся динамику рынка и сигнализировать о смене трендов.

Как это использовать:
EMA/SMA за разные периоды (день, неделя, месяц) для захвата краткосрочных и долгосрочных трендов.
RSI за последние несколько дней и кварталов, чтобы оценить зоны перекупленности или перепроданности.
Volatility (волатильность) за день и месяц для оценки риска и силы движения цены.
Bollinger Bands за разные временные периоды для оценки волатильности и отклонений цены от среднего значения.

Итог:
Добавление технических метрик за разные периоды создаст дополнительную глубину и контекст для модели. Это улучшит её способность реагировать как на краткосрочные рыночные колебания, так и на долгосрочные тренды.

Итеративный процесс предсказания:

Предсказание OHLC:
Сначала предсказываешь значения open, high, low, close для текущего дня.

Расчет технических индикаторов:
На основе предсказанных OHLC-данных вычисляешь технические индикаторы, такие как EMA, RSI, MACD, и другие.

Использование технических индикаторов:
Технические индикаторы за текущий день можно добавить в качестве признаков для предсказания следующего дня.

Повторение:
Для следующей строки используешь уже предсказанные OHLC-значения и вычисленные индикаторы, чтобы предсказать новые параметры OHLC. Затем снова рассчитываешь индикаторы и продолжаешь процесс для всех последующих строк.

Важные моменты:

Каскадный эффект ошибок: Итеративное использование предсказанных значений может привести к накоплению ошибок. Если модель делает небольшую ошибку на одном шаге, она может усилиться в следующих итерациях. Это необходимо учитывать, и важно хорошо тестировать модель.

Применение фильтров: Для сглаживания возможных ошибок можно использовать фильтры (например, Kalman filter) или другие методы, которые минимизируют влияние накопленных ошибок на предсказания.

Альтернативный подход: Некоторые модели могут быть обучены сразу предсказывать будущие технические индикаторы (например, предсказывать будущий EMA или RSI) одновременно с OHLC. Это может упростить процесс и снизить риск накопления ошибок.

Итог:
Твой подход логичен, и он позволяет модельной системе учитывать изменения технических индикаторов на протяжении времени. Однако из-за потенциального каскадного накопления ошибок стоит учитывать возможные методы снижения их влияния.

Да, ты правильно понимаешь. Создание признаков, таких как last_ema, last_rsi, last_macd, и last_{ohlc} (например, last_open, last_close и т.д.), позволит модели учитывать предыдущие значения индикаторов и OHLC при прогнозировании будущих значений. Это особенно важно для временных рядов, где текущие значения зависят от предыдущих.

Почему это работает:
Зависимости во времени: Финансовые временные ряды сильно зависят от предыдущих значений. Включив последние значения технических индикаторов и OHLC, ты предоставишь модели важный контекст для прогнозирования.

Лаговые признаки: Такие признаки часто называются лаговыми. Например, last_ema будет значением EMA на предыдущий день. Это стандартный подход для временных рядов.

Дополнение к текущим значениям: Вместо того чтобы предсказывать OHLC исключительно на основе текущих данных, такие лаговые признаки позволят модели лучше уловить динамику и тренды в данных.

Как это сделать:
Для каждого признака, который ты считаешь важным для прогноза (например, ema, rsi, macd, open, close и т.д.), создаешь соответствующий лаговый признак с помощью смещения (shift в pandas).
Лаговые признаки можно создавать для нескольких периодов, например last_ema_1, last_ema_2 (для предыдущего дня и дня до него).
Этот подход поможет модели лучше улавливать изменения в данных и сделает прогнозы более точными.

Создание лаговых признаков (например, last_ema, last_rsi, и last_{ohlc}) само по себе не обязательно создаст линейную зависимость, но оно внесёт автокорреляцию, что характерно для временных рядов. В таких задачах автокорреляция — это ожидаемое поведение, потому что текущие значения часто зависят от прошлых.

Автокорреляция vs Линейная зависимость:
Автокорреляция: В финансовых временных рядах важно учитывать прошлые значения, так как цена в будущем зависит от текущей и предыдущей динамики. Это не обязательно приводит к проблемам, так как модели временных рядов (например, ARIMA или LSTM) используют прошлые данные для прогноза будущих значений.

Линейная зависимость (или мультиколлинеарность): Если признаки сильно коррелируют друг с другом (например, несколько очень похожих лаговых признаков), это может затруднить обучение модели и привести к переобучению. Однако для временных рядов это часто не критично, особенно если используются такие модели, как градиентный бустинг или нейронные сети, которые хорошо справляются с подобными зависимостями.

Как избежать проблем с зависимостями:
Регуляризация: Важно применять регуляризацию (например, L2 или L1), если используешь модели, чувствительные к мультиколлинеарности, такие как линейная регрессия.

Отбор признаков: Ты можешь уменьшить количество лаговых признаков, оставляя, например, только last_ema_1, если видишь, что добавление нескольких лагов не приносит пользы. Методы отбора признаков помогут выявить наиболее важные признаки.

Проверка на мультиколлинеарность: Если ты беспокоишься о линейных зависимостях, можешь оценить корреляцию между признаками и избавиться от тех, которые сильно коррелируют друг с другом.

Вывод:
Лаговые признаки создают временную зависимость (автокорреляцию), что в данном случае является нормальным и полезным для модели. Линейная зависимость может возникнуть только если признаки избыточно похожи друг на друга, но этого можно избежать регуляризацией и отбором признаков.
#%%
